## 一、Neugebauer方程是什么？

**Neugebauer方程**最初由德国科学家 **Hans E. J. Neugebauer** 在1937年提出。它是一种**基于面积覆盖率的加权平均模型**，用于预测打印时不同颜色油墨（如青C、品M、黄Y、黑K）在纸上叠加后产生的视觉颜色。

它的基本思想是：

> 一个像素点上的颜色，可以看作是不同油墨组合的区域混合而成的颜色加权平均。

### 公式原型：


对于CMY三色印刷（不考虑黑K），Neugebauer模型可以表示为：

$$
\mathbf{C} = \sum_{i=1}^{8} a_i \cdot \mathbf{C}_i
$$

- $C$：预测得到的颜色值（可以是XYZ、Lab、RGB等色彩空间的值）
- $C_i$：每种油墨组合（如C、M、Y、CM、CY、MY、CMY、空白）的反射颜色
- $a_i$：每种组合在图像中所占的面积比例（面积覆盖率），满足 $\sum a_i = 1$

------

## 二、Neugebauer方程的用途

### ✅1. **颜色预测**

用于预测在一定油墨配比下，纸上所呈现的颜色。这在**色彩管理系统（CMS）**中至关重要，尤其在打样或打印机校准阶段。

### ✅2. **色彩反演（反向模型）**

可用于给定目标颜色，反推出应使用的油墨覆盖率（尽管原始Neugebauer模型是正向的，反向需要迭代或神经网络辅助）。

### ✅3. **G7、ICC色彩校准中基础模型**

比如在G7灰平衡校准中，需要知道各个油墨层组合在纸上产生的颜色才能进行准确调整。

### ✅4. **四色印刷模拟与油墨节省优化**

在数字印刷模拟系统中，通过Neugebauer模型可以提前知道哪些区域可以用GCR（灰色成分替代）技术降低油墨使用量而不影响感知颜色。

------

## 三、Neugebauer模型的扩展（现代使用）

Neugebauer原始模型是线性的，不能很好地处理印刷中油墨间的非线性交互。为了提高预测精度，研究人员发展了多个扩展模型：

| 名称                      | 特点                                         |
| ------------------------- | -------------------------------------------- |
| Yule-Nielsen 修正模型     | 引入一个指数因子 n，用于校正“光学点扩散”效应 |
| Demichel模型              | 更精确地计算叠印区域的面积分布               |
| Neugebauer Spectral Model | 使用光谱反射率而非XYZ/Lab来预测颜色，更精确  |
| Kubelka–Munk模型结合      | 考虑油墨的光吸收/散射属性                    |



------

## 四、简单举例说明

假设一个印刷点由三种叠印组合构成：

- 青色墨水：30%面积
- 品红墨水：40%面积
- 青+品红：30%面积

假设它们在Lab颜色空间下的颜色分别是：

- 青：L=60, a=-40, b=-20
- 品红：L=55, a=60, b=-30
- 青+品红：L=50, a=30, b=-40

那么最终预测颜色就是这些值的加权平均：

$$
L = 0.3 \cdot 60 + 0.4 \cdot 55 + 0.3 \cdot 50 = 55.5
\\
a = 0.3 \cdot (-40) + 0.4 \cdot 60 + 0.3 \cdot 30 = 24
\\
b = 0.3 \cdot (-20) + 0.4 \cdot (-30) + 0.3 \cdot (-40) = -30
$$

------

## 五、总结

| 特点     | 描述                                   |
| -------- | -------------------------------------- |
| 模型类型 | 加权平均色彩模型（区域加权）           |
| 适用场景 | 半色调印刷颜色预测、校准、反演         |
| 主要变量 | 面积覆盖率、单色/组合色的测量色值      |
| 优势     | 简单、计算量小、物理意义明确           |
| 局限     | 不考虑光散射、油墨间相互影响，精度有限 |